
CREATE TABLE IF NOT EXISTS EDW_TER.Violator_Stage
(
  violatorid INT64 NOT NULL,
  vidseq INT64 NOT NULL,
  licplatenbr STRING NOT NULL,
  licplatestatelookupid INT64 NOT NULL,
  vehiclemake STRING NOT NULL,
  vehiclemodel STRING NOT NULL,
  vehicleyear STRING NOT NULL,
  docnum STRING,
  vin STRING,
  primaryviolatorfname STRING,
  primaryviolatorlname STRING,
  secondaryviolatorfname STRING,
  secondaryviolatorlname STRING,
  driverslicense STRING,
  driverslicensestatelookupid INT64 NOT NULL,
  secondarydriverslicense STRING,
  secondarydriverslicensestatelookupid INT64 NOT NULL,
  earliesthvtrandate DATETIME NOT NULL,
  latesthvtrandate DATETIME NOT NULL,
  admincountylookupid INT64 NOT NULL,
  registrationcountylookupid INT64 NOT NULL,
  registrationdatenextmonth INT64 NOT NULL,
  registrationdatenextyear INT64 NOT NULL,
  violatoragencylookupid INT64 NOT NULL,
  violatoraddresssourcelookupid INT64 NOT NULL,
  violatoraddressstatuslookupid INT64 NOT NULL,
  activeflag INT64 NOT NULL,
  confirmedflag INT64 NOT NULL,
  address1 STRING NOT NULL,
  address2 STRING,
  city STRING NOT NULL,
  statelookupid INT64 NOT NULL,
  zipcode STRING NOT NULL,
  plus4 STRING,
  violatoraddresscreatedate DATETIME NOT NULL,
  violatoraddresscreatedby STRING NOT NULL,
  violatoraddressupdatedate DATETIME,
  violatoraddressupdatedby STRING,
  violaddr_last_update_type STRING NOT NULL,
  violaddr_last_update_date DATETIME NOT NULL
)
cluster by violatorid,vidseq
;
